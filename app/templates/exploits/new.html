{% extends "base.html" %}
{% set active_page = "New Exploit" %}
{% block content %}
    <script>
        window.history.replaceState({}, document.title, "/" + "exploits/new");
    </script>
    <form action="/api/exploits/create" method="post">
        <div class="input-group mb-3">
            <select class="form-control" name="template" id="select-template" onchange="document.location = '/exploits/new?template=' + document.getElementById('select-template').value;">
                <option value="" selected>Load Template...</option>
                {% for template in templates %}
                    <option value="{{ template }}" >{{ template }}</option>
                {% endfor %}
            </select>
        </div>
        {{ input("Name", "name", "text") }}
        {{ input("Frequency (s)", "frequency", "number", "60") }}
        <select class="form-control" name="service_Id" required>
            <option value="" selected>Select target service</option>
            {% for service in services.values() %}
                <option value="{{ service.id }}">{{ service.name }}</option>
            {% endfor %}
        </select>
        <br/>
        <div class="form-group">
            <h3>Exploit Script</h3>
            <p>Scripts will be run with the following syntax: ./script &lt;target_ip&gt;</p>
            <code>
                <textarea class="form-control" id="code" name="code" rows="20">{{ code }}</textarea>
            </code>
        </div>
        <a class="btn btn-secondary" href="/exploits">Back</a>
        <button type="submit" class="btn btn-primary">Save</button>
    </form>
{% endblock %}